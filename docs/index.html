<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1" />
<meta name="generator" content="pdoc 0.10.0" />
<title>eff_word_net API documentation</title>
<meta name="description" content="EfficientWord-Net
![Versions : 3.6 ‚Ä¶" />
<link rel="preload stylesheet" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/11.0.1/sanitize.min.css" integrity="sha256-PK9q560IAAa6WVRRh76LtCaI8pjTJ2z11v0miyNNjrs=" crossorigin>
<link rel="preload stylesheet" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/11.0.1/typography.min.css" integrity="sha256-7l/o7C8jubJiy74VsKTidCy1yBkRtiUGbVkYBylBqUg=" crossorigin>
<link rel="stylesheet preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/styles/github.min.css" crossorigin>
<style>:root{--highlight-color:#fe9}.flex{display:flex !important}body{line-height:1.5em}#content{padding:20px}#sidebar{padding:30px;overflow:hidden}#sidebar > *:last-child{margin-bottom:2cm}.http-server-breadcrumbs{font-size:130%;margin:0 0 15px 0}#footer{font-size:.75em;padding:5px 30px;border-top:1px solid #ddd;text-align:right}#footer p{margin:0 0 0 1em;display:inline-block}#footer p:last-child{margin-right:30px}h1,h2,h3,h4,h5{font-weight:300}h1{font-size:2.5em;line-height:1.1em}h2{font-size:1.75em;margin:1em 0 .50em 0}h3{font-size:1.4em;margin:25px 0 10px 0}h4{margin:0;font-size:105%}h1:target,h2:target,h3:target,h4:target,h5:target,h6:target{background:var(--highlight-color);padding:.2em 0}a{color:#058;text-decoration:none;transition:color .3s ease-in-out}a:hover{color:#e82}.title code{font-weight:bold}h2[id^="header-"]{margin-top:2em}.ident{color:#900}pre code{background:#f8f8f8;font-size:.8em;line-height:1.4em}code{background:#f2f2f1;padding:1px 4px;overflow-wrap:break-word}h1 code{background:transparent}pre{background:#f8f8f8;border:0;border-top:1px solid #ccc;border-bottom:1px solid #ccc;margin:1em 0;padding:1ex}#http-server-module-list{display:flex;flex-flow:column}#http-server-module-list div{display:flex}#http-server-module-list dt{min-width:10%}#http-server-module-list p{margin-top:0}.toc ul,#index{list-style-type:none;margin:0;padding:0}#index code{background:transparent}#index h3{border-bottom:1px solid #ddd}#index ul{padding:0}#index h4{margin-top:.6em;font-weight:bold}@media (min-width:200ex){#index .two-column{column-count:2}}@media (min-width:300ex){#index .two-column{column-count:3}}dl{margin-bottom:2em}dl dl:last-child{margin-bottom:4em}dd{margin:0 0 1em 3em}#header-classes + dl > dd{margin-bottom:3em}dd dd{margin-left:2em}dd p{margin:10px 0}.name{background:#eee;font-weight:bold;font-size:.85em;padding:5px 10px;display:inline-block;min-width:40%}.name:hover{background:#e0e0e0}dt:target .name{background:var(--highlight-color)}.name > span:first-child{white-space:nowrap}.name.class > span:nth-child(2){margin-left:.4em}.inherited{color:#999;border-left:5px solid #eee;padding-left:1em}.inheritance em{font-style:normal;font-weight:bold}.desc h2{font-weight:400;font-size:1.25em}.desc h3{font-size:1em}.desc dt code{background:inherit}.source summary,.git-link-div{color:#666;text-align:right;font-weight:400;font-size:.8em;text-transform:uppercase}.source summary > *{white-space:nowrap;cursor:pointer}.git-link{color:inherit;margin-left:1em}.source pre{max-height:500px;overflow:auto;margin:0}.source pre code{font-size:12px;overflow:visible}.hlist{list-style:none}.hlist li{display:inline}.hlist li:after{content:',\2002'}.hlist li:last-child:after{content:none}.hlist .hlist{display:inline;padding-left:1em}img{max-width:100%}td{padding:0 .5em}.admonition{padding:.1em .5em;margin-bottom:1em}.admonition-title{font-weight:bold}.admonition.note,.admonition.info,.admonition.important{background:#aef}.admonition.todo,.admonition.versionadded,.admonition.tip,.admonition.hint{background:#dfd}.admonition.warning,.admonition.versionchanged,.admonition.deprecated{background:#fd4}.admonition.error,.admonition.danger,.admonition.caution{background:lightpink}</style>
<style media="screen and (min-width: 700px)">@media screen and (min-width:700px){#sidebar{width:30%;height:100vh;overflow:auto;position:sticky;top:0}#content{width:70%;max-width:100ch;padding:3em 4em;border-left:1px solid #ddd}pre code{font-size:1em}.item .name{font-size:1em}main{display:flex;flex-direction:row-reverse;justify-content:flex-end}.toc ul ul,#index ul{padding-left:1.5em}.toc > ul > li{margin-top:.5em}}</style>
<style media="print">@media print{#sidebar h1{page-break-before:always}.source{display:none}}@media print{*{background:transparent !important;color:#000 !important;box-shadow:none !important;text-shadow:none !important}a[href]:after{content:" (" attr(href) ")";font-size:90%}a[href][title]:after{content:none}abbr[title]:after{content:" (" attr(title) ")"}.ir a:after,a[href^="javascript:"]:after,a[href^="#"]:after{content:""}pre,blockquote{border:1px solid #999;page-break-inside:avoid}thead{display:table-header-group}tr,img{page-break-inside:avoid}img{max-width:100% !important}@page{margin:0.5cm}p,h2,h3{orphans:3;widows:3}h1,h2,h3,h4,h5,h6{page-break-after:avoid}}</style>
<script defer src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/highlight.min.js" integrity="sha256-Uv3H6lx7dJmRfRvH8TH6kJD1TSK1aFcwgx+mdg3epi8=" crossorigin></script>
<script>window.addEventListener('DOMContentLoaded', () => hljs.initHighlighting())</script>
</head>
<body>
<main>
<article id="content">
<header>
<h1 class="title">Package <code>eff_word_net</code></h1>
</header>
<section id="section-intro">
<h1 id="efficientword-net">EfficientWord-Net</h1>
<p><img alt="Versions : 3.6 ,3.7,3.8,3.9" src="https://camo.githubusercontent.com/a7b5b417de938c1faf3602c7f48f26fde8761a977be85390fd6c0d191e210ba8/68747470733a2f2f696d672e736869656c64732e696f2f707970692f707976657273696f6e732f74656e736f72666c6f772e7376673f7374796c653d706c6173746963"></p>
<h2 id="hotword-detection-based-on-one-shot-learning">Hotword detection based on one-shot learning</h2>
<p>Home assistants require special phrases called hotwords to get activated (eg:"ok google")</p>
<p>EfficientWord-Net is an hotword detection engine based on one-shot
learning inspired from FaceNet's Siamese Network Architecture.
Works very similar to face recognition , just requires a few samples of your own custom hotword to get going.
<strong>No extra training or huge datasets required!!</strong>
This will allow developers to add custom hotwords to their programs without a sweat or any extra charges.
Just like google assistant's hotword detector, the engine performs the best when 3-4 hotword samples are collected directly from the user
This repository is an official implemenation of EfficientWord-Net as
a python library from the authors.</p>
<p>The library is purely written with python and uses Google's Tflite
implemenation for faster realtime inference.</p>
<h3 id="demo-of-efficientword-net-in-pi">Demo of EfficientWord-Net in Pi</h3>
<p><a href="https://user-images.githubusercontent.com/44740048/139785995-3330d65a-cfe1-4e92-8769-ee389a122acc.mp4">https://user-images.githubusercontent.com/44740048/139785995-3330d65a-cfe1-4e92-8769-ee389a122acc.mp4</a></p>
<h2 id="access-preprint">Access preprint</h2>
<p>The research paper is currently under review in IEEE, <a href="https://arxiv.org/abs/2111.00379">click here</a> to access the preprint and the training code will be available for public access once the paper is published.
<br></p>
<h2 id="python-version-requirements">Python Version Requirements</h2>
<p>This Library works between python versions:
<code>3.6 to 3.9</code>
<br></p>
<h2 id="dependencies-installation">Dependencies Installation</h2>
<p>Before running the pip installation command for the library, few dependencies need to be installed manually.</p>
<ul>
<li><a href="https://abhgog.gitbooks.io/pyaudio-manual/content/installation.html">PyAudio (depends on PortAudio)</a></li>
<li><a href="https://www.tensorflow.org/lite/guide/python#install_tensorflow_lite_for_python">Tflite (tensorflow lightweight binaries)</a></li>
<li><a href="https://github.com/librosa/librosa">Librosa (Binaries might not be available for certain systems)</a>
Mac OS M* and Raspberry Pi users might have to compile these dependecies.</li>
</ul>
<p><strong><em>tflite</em></strong> package cannot be listed in requirements.txt hence will be automatically installed when the package is initialized in the system.</p>
<p><strong><em>librosa</em></strong> package is not required for inference only cases , however when generate_reference is called , will be automatically installed.</p>
<p><br></p>
<h2 id="package-installation">Package Installation</h2>
<p>Run the following pip command</p>
<pre><code>pip install EfficientWord-Net
</code></pre>
<p>and to import running</p>
<pre><code>import eff_word_net
</code></pre>
<p><br></p>
<h2 id="demo">Demo</h2>
<p>After installing the packages, you can run the Demo
script inbuilt with library (ensure you have a working mic).</p>
<p>Accesss Documentation from : <a href="https://ant-brain.github.io/EfficientWord-Net/">https://ant-brain.github.io/EfficientWord-Net/</a></p>
<p>Command to run demo</p>
<pre><code>python -m eff_word_net.engine
</code></pre>
<p><br></p>
<h2 id="generating-custom-wakewords">Generating Custom Wakewords</h2>
<p>For any new hotword, the library needs information about the hotword, this
information is obtained from a file called <code>{wakeword}_ref.json</code>.
Eg: For the wakeword 'alexa', the library would need the file called <code>alexa_ref.json</code></p>
<p>These files can be generated with the following procedure:</p>
<p>One needs to collect few 4 to 10 uniquely sounding pronunciations
of a given wakeword. Then put them into a seperate folder, which doesnt contain
anything else.</p>
<p>Or one could use the following command to generate audio files for a given word, uses ibm neural tts demo api, Kindly dont over use it for our sake (lol)</p>
<pre><code class="language-bash">python -m eff_word_net.ibm_generate
</code></pre>
<p>Finally run this command, it will ask for the input folder's location
(containing the audio files) and the output folder (where _ref.json file will be stored).</p>
<pre><code>python -m eff_word_net.generate_reference
</code></pre>
<p>The pathname of the generated wakeword needs to passed to the HotwordDetector detector instance.</p>
<pre><code class="language-python">HotwordDetector(
        hotword=&quot;hello&quot;,
        reference_file = &quot;/full/path/name/of/hello_ref.json&quot;),
        threshold=0.9, #min confidence required to consider a trigger
        relaxation_time = 0.8 #default value ,in seconds
)
</code></pre>
<p>relaxation time parameter is used to determine the min time between any 2 triggers, any potential triggers before the relaxation_time will be cancelled</p>
<p>The detector operates on a sliding widow approach resulting in multiple triggers for single utterance of a hotword, the relaxation_time parameter can used to control the multiple triggers, in most cases 0.8sec(default) will do </p>
<p><br></p>
<h2 id="out-of-the-box-sample-hotwords">Out of the box sample hotwords</h2>
<p>Few wakewords such as <strong>Mycroft</strong>, <strong>Google</strong>, <strong>Firefox</strong>, <strong>Alexa</strong>, <strong>Mobile</strong>, <strong>Siri</strong> the library has predefined embeddings readily available in the library installation directory, its path is readily available in the following variable</p>
<pre><code class="language-python">from eff_word_net import samples_loc
</code></pre>
<p><br></p>
<h2 id="try-your-first-single-hotword-detection-script">Try your first single hotword detection script</h2>
<pre><code class="language-python">import os
from eff_word_net.streams import SimpleMicStream
from eff_word_net.engine import HotwordDetector
from eff_word_net import samples_loc

mycroft_hw = HotwordDetector(
        hotword=&quot;Mycroft&quot;,
        reference_file = os.path.join(samples_loc,&quot;mycroft_ref.json&quot;),
    )

mic_stream = SimpleMicStream()
mic_stream.start_stream()

print(&quot;Say Mycroft &quot;)
while True :
    frame = mic_stream.getFrame()
    result = mycroft_hw.scoreFrame(frame)
    if result==None :
        #no voice activity
        continue
    if(result[&quot;match&quot;]):
        print(&quot;Wakeword uttered&quot;,result[&quot;confidence&quot;])

</code></pre>
<p><br></p>
<h2 id="detecting-mulitple-hotwords-from-audio-streams">Detecting Mulitple Hotwords from audio streams</h2>
<p>The library provides a computation friendly way
to detect multiple hotwords from a given stream, instead of running <code>scoreFrame()</code> of each wakeword individually</p>
<pre><code class="language-python">import os
from eff_word_net.streams import SimpleMicStream
from eff_word_net import samples_loc
print(samples_loc)

alexa_hw = HotwordDetector(
        hotword=&quot;Alexa&quot;,
        reference_file = os.path.join(samples_loc,&quot;alexa_ref.json&quot;),
    )

siri_hw = HotwordDetector(
        hotword=&quot;Siri&quot;,
        reference_file = os.path.join(samples_loc,&quot;siri_ref.json&quot;),
    )

mycroft_hw = HotwordDetector(
        hotword=&quot;mycroft&quot;,
        reference_file = os.path.join(samples_loc,&quot;mycroft_ref.json&quot;),
        activation_count=3
    )

multi_hw_engine = MultiHotwordDetector(
        detector_collection = [
            alexa_hw,
            siri_hw,
            mycroft_hw,
        ],
    )

mic_stream = SimpleMicStream()
mic_stream.start_stream()

print(&quot;Say Mycroft / Alexa / Siri&quot;)

while True :
    frame = mic_stream.getFrame()
    result = multi_hw_engine.findBestMatch(frame)
    if(None not in result):
        print(result[0],f&quot;,Confidence {result[1]:0.4f}&quot;)

</code></pre>
<p><br></p>
<p>Access documentation of the library from here : <a href="https://ant-brain.github.io/EfficientWord-Net/">https://ant-brain.github.io/EfficientWord-Net/</a></p>
<h2 id="change-notes-from-v011-to-022">Change notes from v0.1.1 to 0.2.2</h2>
<p>major changes to replace complex friking logic of handling poly triggers per utterance into more simpler logic and more simpler api for programmers</p>
<p>Introduces breaking changes</p>
<h2 id="faq">FAQ :</h2>
<ul>
<li><strong>Hotword Perfomance is bad</strong> : if you are having some issue like this , feel to ask the same in <a href="https://github.com/Ant-Brain/EfficientWord-Net/discussions/4">discussions</a></li>
</ul>
<h2 id="contribution">CONTRIBUTION:</h2>
<ul>
<li>If you have an ideas to make the project better, feel free to ping us in <a href="https://github.com/Ant-Brain/EfficientWord-Net/discussions/3">discussions</a></li>
<li>The current <a href="/eff_word_net/logmelcalc.tflite">logmelcalc.tflite</a> graph can convert only 1 audio frame to Log Mel Spectrogram at a time. It will be of a great help if tensorflow guru's outthere help us out with this.</li>
</ul>
<h2 id="todo">TODO :</h2>
<ul>
<li>Add audio file handler in streams. PR's are welcome.</li>
<li>Remove librosa requirement to encourage generating reference files directly in edge devices</li>
<li>Add more detailed documentation explaining slider window concept</li>
</ul>
<h2 id="support-us">SUPPORT US:</h2>
<p>Our hotword detector's performance is notably low when compared to Porcupine. We have thought about better NN architectures for the engine and hope to outperform Porcupine. This has been our undergrad project. Hence your support and encouragement will motivate us to develop the engine. If you loved this project recommend this to your peers, give us a üåü in Github and a clap üëè in <a href="https://link.medium.com/yMBmWGM03kb">medium</a>.</p>
<h2 id="licencse-apache-license-20">LICENCSE : <a href="/LICENSE.md">Apache License 2.0</a></h2>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">&#34;&#34;&#34;
.. include:: ../README.md
&#34;&#34;&#34;

import os
RATE=16000
samples_loc = os.path.join(os.path.dirname(os.path.realpath(__file__)),&#34;sample_refs&#34;)

from eff_word_net.package_installation_scripts import check_install_tflite

check_install_tflite()</code></pre>
</details>
</section>
<section>
<h2 class="section-title" id="header-submodules">Sub-modules</h2>
<dl>
<dt><code class="name"><a title="eff_word_net.audio_processing" href="audio_processing.html">eff_word_net.audio_processing</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt><code class="name"><a title="eff_word_net.engine" href="engine.html">eff_word_net.engine</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt><code class="name"><a title="eff_word_net.generate_reference" href="generate_reference.html">eff_word_net.generate_reference</a></code></dt>
<dd>
<div class="desc"><p>Can be run directly in cli
<code>python -m efficientword.generate_reference</code></p></div>
</dd>
<dt><code class="name"><a title="eff_word_net.ibm_generate" href="ibm_generate.html">eff_word_net.ibm_generate</a></code></dt>
<dd>
<div class="desc"><p>Needs to be run directly in cli via
<code>python -m efficientword.ibm_generate</code> ‚Ä¶</p></div>
</dd>
<dt><code class="name"><a title="eff_word_net.package_installation_scripts" href="package_installation_scripts.html">eff_word_net.package_installation_scripts</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt><code class="name"><a title="eff_word_net.streams" href="streams.html">eff_word_net.streams</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
</dl>
</section>
<section>
</section>
<section>
</section>
<section>
</section>
</article>
<nav id="sidebar">
<h1>Index</h1>
<div class="toc">
<ul>
<li><a href="#efficientword-net">EfficientWord-Net</a><ul>
<li><a href="#hotword-detection-based-on-one-shot-learning">Hotword detection based on one-shot learning</a><ul>
<li><a href="#demo-of-efficientword-net-in-pi">Demo of EfficientWord-Net in Pi</a></li>
</ul>
</li>
<li><a href="#access-preprint">Access preprint</a></li>
<li><a href="#python-version-requirements">Python Version Requirements</a></li>
<li><a href="#dependencies-installation">Dependencies Installation</a></li>
<li><a href="#package-installation">Package Installation</a></li>
<li><a href="#demo">Demo</a></li>
<li><a href="#generating-custom-wakewords">Generating Custom Wakewords</a></li>
<li><a href="#out-of-the-box-sample-hotwords">Out of the box sample hotwords</a></li>
<li><a href="#try-your-first-single-hotword-detection-script">Try your first single hotword detection script</a></li>
<li><a href="#detecting-mulitple-hotwords-from-audio-streams">Detecting Mulitple Hotwords from audio streams</a></li>
<li><a href="#change-notes-from-v011-to-022">Change notes from v0.1.1 to 0.2.2</a></li>
<li><a href="#faq">FAQ :</a></li>
<li><a href="#contribution">CONTRIBUTION:</a></li>
<li><a href="#todo">TODO :</a></li>
<li><a href="#support-us">SUPPORT US:</a></li>
<li><a href="#licencse-apache-license-20">LICENCSE : Apache License 2.0</a></li>
</ul>
</li>
</ul>
</div>
<ul id="index">
<li><h3><a href="#header-submodules">Sub-modules</a></h3>
<ul>
<li><code><a title="eff_word_net.audio_processing" href="audio_processing.html">eff_word_net.audio_processing</a></code></li>
<li><code><a title="eff_word_net.engine" href="engine.html">eff_word_net.engine</a></code></li>
<li><code><a title="eff_word_net.generate_reference" href="generate_reference.html">eff_word_net.generate_reference</a></code></li>
<li><code><a title="eff_word_net.ibm_generate" href="ibm_generate.html">eff_word_net.ibm_generate</a></code></li>
<li><code><a title="eff_word_net.package_installation_scripts" href="package_installation_scripts.html">eff_word_net.package_installation_scripts</a></code></li>
<li><code><a title="eff_word_net.streams" href="streams.html">eff_word_net.streams</a></code></li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc" title="pdoc: Python API documentation generator"><cite>pdoc</cite> 0.10.0</a>.</p>
</footer>
</body>
</html>